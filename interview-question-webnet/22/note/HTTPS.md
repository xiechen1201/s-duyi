# HTTPS

SSL 安全套接字协议

TLS 传输层安全协议

TLS 是 SSL 的升级版。

使用 HTTPS 相当于加了一层 SSL/TLS。

图解：

- A ==> B 发送信息

- 可能被 X 拦截，进行篡改（中间的节点是可以监听的，数据都是明文传输的）

## 解决

使用对称加密。

- B =密钥=> A

- A =密钥+数据=> B

问题是 B 给 A 传输密钥的时候可能被拦截。

- B =密钥被X拦截，并给A一个假密钥=> A

- A =假密钥+数据=> X（数据被篡改，真密钥+数据） ==> A

使用非对称加密。

（一般来说是公钥加密，私钥解密，但是反过来也可以，）

> 发送方使用自己的私钥对消息进行加密（签名）。
> 接收方使用发送方的公钥进行解密（验证签名），以确保消息的完整性和来源的真实性。

- B =(公钥)=> A

- A =(公钥+数据)=> B(私钥+数据)

- B =(公钥+数据)=> A(只有公钥，无法进行解密了)

升级：

- B =(公钥)=> A

- A 生成一个对称加密的密钥

- A =(公钥+对称加密的密钥)=> B（使用私钥解密，得到对称密钥）

- A(对称密钥 + 数据) => B(对称密钥解密)

- B(对称密钥 + 数据) => A(对称密钥解密)

问题：

X 在第一步就进行截取：

B =(公钥被 X 获取，X 又生成一个公钥和私钥)=> A

- A 生成一个对称加密的密钥

- A =(公钥+对称加密的密钥，被 X 破解，得到对称密钥，公钥使用公钥进行加密)=> B（使用私钥解密，得到对称密钥）

如何解决？如何可信？

## CA 结构

就是颁发证书的，需要进行购买。

证书需要绑定到域名。

- B（生成公钥、私钥）=(公钥)=> CA（每一个CA有自己的一套公钥、私钥，私钥不外露，公钥全世界都知道）

- CA =(证书)=> B

证书的内容：

- 网站域名

- 证书颁发机构

- 加密信息1（CA私钥 + B的公钥）

- 加密信息2（CA私钥 + 证书签名）

即使 X 知道了证书的内容，它更改了 B 的公钥，也无法进行加密（因为没有 CA 的私钥）。

签名的内容：

签名 = CA 私钥（域名 + CA 公钥 + B 的公钥）

即使 X 获取到签名，但是无法进行篡改，实在不行就更改证书的域名，但是签名还会给域名进行验证

流程：

- B =（证书）=> A（对证书进行验证，得到 B 的公钥）

- X 无法篡改

- B =(公钥+对称私钥)=> A（私钥破解，得到对称私钥）

## 面试题

1、中间人攻击？

HTTPS 是解决中间人攻击的，但是还是有可能进行劫持攻击的。

劫持攻击：伪造证书。

剥离攻击：骗浏览器服务器不支持证书，直接使用 HTTP 协议（类似代理商的角色）。

2、HTTPS 握手的过程？

3、握手过程中如何验证证书合法性？

4、为什么需要 CA 机构对证书进行签名？

5、如何劫持 HTTPS 请求？

